<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星核演算機 - Stellaron Calculator</title>
    
    <!-- 網站描述 -->
    <meta name="description" content="崩壞星穹鐵道專業傷害計算器，支援角色配置、光錐搭配、儀器詞條評分，精準計算各種攻擊類型的傷害數值。">
    <meta name="keywords" content="崩壞星穹鐵道,星穹鐵道,傷害計算器,儀器評分,角色配置,光錐,HSR,Honkai Star Rail">
    <meta name="author" content="Stellaron Calculator">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="星核演算機 - 崩壞星穹鐵道傷害計算器">
    <meta property="og:description" content="專業的崩壞星穹鐵道傷害計算工具，提供精準的角色配置、光錐搭配建議和儀器詞條評分系統。">
    <meta property="og:site_name" content="星核演算機">
    <meta property="og:locale" content="zh_TW">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="星核演算機 - 崩壞星穹鐵道傷害計算器">
    <meta name="twitter:description" content="專業的崩壞星穹鐵道傷害計算工具，提供精準的角色配置、光錐搭配建議和儀器詞條評分系統。">
    
    <!-- 應用程式資訊 -->
    <meta name="application-name" content="星核演算機">
    <meta name="theme-color" content="#1a1a2e">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>星核演算機 - Stellaron Calculator</h1>
            <p>崩壞星穹鐵道傷害計算器</p>
        </header>

        <main>
            <div class="calculator-grid">
                <!-- 角色和光錐配置並排區域 -->
                <div class="config-cards-container">
                    <!-- 角色配置區域 -->
                    <section class="character-config-card">
                        <div class="character-config-main">
                            <div class="character-config-form">
                                <div class="config-group">
                                    <label for="character-select-btn">選擇角色:</label>
                                    <button id="character-select-btn" class="character-select-btn" type="button">
                                        <span id="character-select-text">請選擇角色</span>
                                    </button>
                                    <input type="hidden" id="character-select" name="character-select" required>
                                </div>
                                <div class="config-group">
                                    <label for="eidolon-select">星魂等級:</label>
                                    <select id="eidolon-select" required>
                                        <option value="0">E0</option>
                                        <option value="1">E1</option>
                                        <option value="2">E2</option>
                                        <option value="3">E3</option>
                                        <option value="4">E4</option>
                                        <option value="5">E5</option>
                                        <option value="6">E6</option>
                                    </select>
                                </div>
                                <div class="config-group">
                                    <label for="attack-type">攻擊類型:</label>
                                    <select id="attack-type" required>
                                        <option value="">請選擇攻擊類型</option>
                                        <option value="普攻">普攻</option>
                                        <option value="戰技">戰技</option>
                                        <option value="終結技">終結技</option>
                                        <option value="追加攻擊">追加攻擊</option>
                                        <option value="dot攻擊">dot攻擊</option>
                                        <option value="憶靈攻擊">憶靈攻擊</option>
                                        <option value="強化普攻">強化普攻</option>
                                        <option value="強化戰技">強化戰技</option>
                                        <option value="強化追加攻擊">強化追加攻擊</option>
                                        <option value="強化憶靈攻擊">強化憶靈攻擊</option>
                                    </select>
                                </div>
                            </div>
                            <div class="character-config-info">
                                <img id="character-avatar" src="" alt="角色圖片" class="character-avatar" onerror="this.style.display='none'">
                                <div class="character-info-list">
                                    <div class="info-row"><span class="info-label">命途</span><span id="char-info-path"></span></div>
                                    <div class="info-row"><span class="info-label">屬性</span><span id="char-info-element"></span></div>
                                    <div class="info-row"><span class="info-label">星數</span><span id="char-info-star"></span></div>
                                    <div class="info-row"><span class="info-label">生命</span><span id="char-info-hp"></span></div>
                                    <div class="info-row"><span class="info-label">攻擊</span><span id="char-info-atk"></span></div>
                                    <div class="info-row"><span class="info-label">防禦</span><span id="char-info-def"></span></div>
                                    <div class="info-row"><span class="info-label">速度</span><span id="char-info-speed"></span></div>
                                    <div class="info-row"><span class="info-label">能量</span><span id="char-info-energy"></span></div>
                                    <div class="info-row"><span class="info-label">版本</span><span id="char-info-version"></span></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 光錐配置區域 -->
                    <section class="lightcone-config-card">
                        <div class="lightcone-config-main">
                            <div class="lightcone-config-form">
                                <div class="config-group">
                                    <label for="lightcone-select-btn">選擇光錐:</label>
                                    <button id="lightcone-select-btn" class="lightcone-select-btn" type="button">
                                        <span id="lightcone-select-text">請選擇光錐</span>
                                    </button>
                                    <input type="hidden" id="lightcone-select" name="lightcone-select" required>
                                </div>
                                <div class="config-group">
                                    <label for="superimpose-select">疊影等級:</label>
                                    <select id="superimpose-select" required>
                                        <option value="1">S1</option>
                                        <option value="2">S2</option>
                                        <option value="3">S3</option>
                                        <option value="4">S4</option>
                                        <option value="5">S5</option>
                                    </select>
                                </div>
                                <div class="config-group">
                                    <div class="lightcone-desc" id="lc-info-desc"></div>
                                </div>
                            </div>
                            <div class="lightcone-config-info">
                                <img id="lightcone-avatar" src="" alt="光錐圖片" class="lightcone-avatar" onerror="this.style.display='none'">
                                <div class="lightcone-info-list">
                                    <div class="info-row"><span class="info-label">命途</span><span id="lc-info-path"></span></div>
                                    <div class="info-row"><span class="info-label">星數</span><span id="lc-info-star"></span></div>
                                    <div class="info-row"><span class="info-label">生命</span><span id="lc-info-hp"></span></div>
                                    <div class="info-row"><span class="info-label">攻擊</span><span id="lc-info-atk"></span></div>
                                    <div class="info-row"><span class="info-label">防禦</span><span id="lc-info-def"></span></div>
                                    <div class="path-mismatch-warning" id="path-mismatch-warning" style="display: none;">
                                        角色命途與光錐命途不同，無法觸發效果
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- 敵人設定與儀器配置並排區域 -->
                <div class="config-cards-container">
                    <!-- 敵人設定區域 -->
                    <section class="enemy-config-card">
                        <h2>敵人設定</h2>
                        <div class="enemy-config-main">
                            <div class="enemy-config-form">
                                <div class="config-group">
                                    <label for="enemy-level">敵人等級:</label>
                                    <input type="number" id="enemy-level" value="90" min="1" max="100" required>
                                </div>
                                <div class="config-group">
                                    <label for="enemy-resistance">敵人額外屬性抗性 (%):</label>
                                    <input type="number" id="enemy-resistance" value="0" min="0" max="100" step="0.1" required>
                                </div>
                                <div class="config-group">
                                    <label for="toughness-broken">韌性條狀態:</label>
                                    <select id="toughness-broken">
                                        <option value="false">未破韌性條</option>
                                        <option value="true">已破韌性條</option>
                                    </select>
                                </div>
                                <div class="config-group">
                                    <label>敵人弱點 (可選):</label>
                                    <div class="weakness-selector">
                                        <label class="weakness-option">
                                            <input type="checkbox" value="物理" class="weakness-checkbox">
                                            <span class="weakness-text physical">物理</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="量子" class="weakness-checkbox">
                                            <span class="weakness-text quantum">量子</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="虛數" class="weakness-checkbox">
                                            <span class="weakness-text imaginary">虛數</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="冰" class="weakness-checkbox">
                                            <span class="weakness-text ice">冰</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="風" class="weakness-checkbox">
                                            <span class="weakness-text wind">風</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="火" class="weakness-checkbox">
                                            <span class="weakness-text fire">火</span>
                                        </label>
                                        <label class="weakness-option">
                                            <input type="checkbox" value="雷" class="weakness-checkbox">
                                            <span class="weakness-text lightning">雷</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 儀器配置區域 -->
                    <section class="instrument-config-card">
                        <h2>儀器配置</h2>
                        <div class="instrument-config-main">
                            <div class="instrument-config-form">
                                <div class="config-group">
                                    <label>儀器選擇:</label>
                                    <button class="relic-select-btn" id="relic-select-btn">
                                        <span class="relic-select-text" id="relic-select-text">請選擇儀器</span>
                                    </button>
                                    <!-- 隱藏的select元素用於保存選擇狀態 -->
                                    <select id="outer-relic-1" class="relic-select" style="display: none;">
                                        <option value="">請選擇外圈儀器1</option>
                                    </select>
                                    <select id="outer-relic-2" class="relic-select" style="display: none;">
                                        <option value="">請選擇外圈儀器2 (可選)</option>
                                    </select>
                                    <select id="inner-relic" style="display: none;">
                                        <option value="">請選擇內圈儀器</option>
                                    </select>
                                </div>
                            </div>
                            <div class="instrument-info-block" id="instrument-info-block" style="display:none;">
                                <div class="instrument-img-container">
                                    <div class="outer-relic-imgs" id="outer-relic-imgs"></div>
                                    <div class="inner-relic-imgs" id="inner-relic-imgs"></div>
                                </div>
                                <div class="instrument-desc-list" id="instrument-desc-list"></div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <!-- 儀器詞條配置 -->
            <section class="relic-stats-section">
                <h2>儀器詞條配置</h2>
                <div class="relic-stats-grid">
                    <div class="relic-piece" data-piece="head">
                        <div class="relic-piece-header">
                            <h3>頭部</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="head" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="head" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="head" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="relic-piece" data-piece="hands">
                        <div class="relic-piece-header">
                            <h3>手部</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="hands" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="hands" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="hands" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="relic-piece" data-piece="body">
                        <div class="relic-piece-header">
                            <h3>軀幹</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="body" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="body" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="body" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="relic-piece" data-piece="feet">
                        <div class="relic-piece-header">
                            <h3>腳部</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="feet" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="feet" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="feet" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="relic-piece" data-piece="sphere">
                        <div class="relic-piece-header">
                            <h3>位面球</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="sphere" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="sphere" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="sphere" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>

                    <div class="relic-piece" data-piece="rope">
                        <div class="relic-piece-header">
                            <h3>連結繩</h3>
                            <div class="random-buttons">
                                <button class="random-btn" data-piece="rope" title="隨機生成">🎲</button>
                                <button class="lucky-random-btn" data-piece="rope" title="幸運隨機生成">🎲</button>
                                <button class="super-lucky-random-btn" data-piece="rope" title="超級幸運隨機生成">🎲</button>
                                <button class="random-info-btn" title="隨機生成說明">ℹ️</button>
                            </div>
                        </div>
                        <div class="relic-rating">評分: <span class="rating-value">-</span></div>
                        <div class="main-stat">
                            <label>主詞條:</label>
                            <select class="main-stat-select">
                                <option value="">請選擇主詞條</option>
                            </select>
                            <input type="number" class="main-stat-value" placeholder="數值" step="0.1">
                        </div>
                        <div class="sub-stats">
                            <h4>副詞條:</h4>
                            <div class="sub-stat" data-index="0">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="1">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="2">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                            <div class="sub-stat" data-index="3">
                                <select class="sub-stat-type">
                                    <option value="">請選擇副詞條類型</option>
                                </select>
                                <input type="number" class="sub-stat-value" placeholder="數值" step="0.1">
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 計算按鈕 -->
            <div class="calculate-section">
                <button id="calculate-btn" class="calculate-btn">計算傷害</button>
            </div>

            <!-- 結果顯示區域 -->
            <section class="results-section" id="results-section" style="display: none;">
                <h2>計算結果</h2>
                <div class="results-grid">
                    <div class="result-card">
                        <h3>未爆擊傷害</h3>
                        <div class="damage-value" id="final-damage">0</div>
                    </div>
                    <div class="result-card">
                        <h3>全暴擊傷害</h3>
                        <div class="damage-value" id="crit-damage">0</div>
                    </div>
                    <div class="result-card">
                        <h3>期望值傷害</h3>
                        <div class="damage-value" id="avg-damage">0</div>
                    </div>
                </div>
                
                <div class="stats-breakdown">
                    <h3>詳細數據</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">攻擊力:</span>
                            <div class="stat-value-container">
                                <span class="stat-value" id="total-atk">0</span>
                                <div class="stat-breakdown" id="atk-breakdown"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">攻擊力加成:</span>
                            <span class="stat-value" id="atk-bonus">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">技能倍率:</span>
                            <span class="stat-value" id="skill-multiplier">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">增傷加成:</span>
                            <span class="stat-value" id="dmg-bonus">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">暴擊率:</span>
                            <span class="stat-value" id="crit-rate">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">暴擊傷害:</span>
                            <span class="stat-value" id="crit-dmg">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">易傷加成:</span>
                            <span class="stat-value" id="vulnerability">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">防禦減免:</span>
                            <span class="stat-value" id="def-reduction">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">抗性減免:</span>
                            <span class="stat-value" id="resistance-reduction">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">實際抗性:</span>
                            <span class="stat-value" id="actual-resistance">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">總儀器評分:</span>
                            <span class="stat-value" id="total-relic-rating">-</span>
                        </div>
                    </div>
                    
                    <h3>角色屬性</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">生命值:</span>
                            <div class="stat-value-container">
                                <span class="stat-value" id="total-hp">0</span>
                                <div class="stat-breakdown" id="hp-breakdown"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">防禦力:</span>
                            <div class="stat-value-container">
                                <span class="stat-value" id="total-def">0</span>
                                <div class="stat-breakdown" id="def-breakdown"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">速度:</span>
                            <div class="stat-value-container">
                                <span class="stat-value" id="total-speed">0</span>
                                <div class="stat-breakdown" id="speed-breakdown"></div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">擊破特攻:</span>
                            <span class="stat-value" id="total-break-effect">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">治療量加成:</span>
                            <span class="stat-value" id="total-healing-bonus">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">效果命中:</span>
                            <span class="stat-value" id="total-effect-hit">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">效果抵抗:</span>
                            <span class="stat-value" id="total-effect-res">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">能量恢復效率:</span>
                            <span class="stat-value" id="total-energy-regen">100%</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- 浮動設定按鈕 -->
    <button id="floating-settings-btn" class="floating-settings-btn" title="設定">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 8 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.6 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 8a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 8 4.6a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09c0 .66.39 1.25 1 1.51a1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 8c.66 0 1.25.39 1.51 1H21a2 2 0 0 1 0 4h-.09c-.66 0-1.25.39-1.51 1z"/></svg>
    </button>

    <!-- 設定彈窗 -->
    <div id="settings-modal" class="settings-modal">
        <div class="settings-modal-content">
            <div class="settings-modal-sidebar">
                <div class="settings-modal-sidebar-item active">一般</div>
            </div>
            <div class="settings-modal-main">
                <button class="settings-modal-close" id="settings-modal-close" title="關閉">&times;</button>
                <h2>設定</h2>
                <div class="settings-section-modal">
                    <div class="setting-item">
                        <label for="modal-decimal-places">數值顯示詳細程度：</label>
                        <select id="modal-decimal-places">
                            <option value="0">0位小數</option>
                            <option value="1">1位小數</option>
                            <option value="2" selected>2位小數</option>
                            <option value="3">3位小數</option>
                            <option value="4">4位小數</option>
                            <option value="5">5位小數</option>
                            <option value="6">6位小數</option>
                            <option value="7">7位小數</option>
                            <option value="8">8位小數</option>
                            <option value="9">9位小數</option>
                            <option value="10">10位小數</option>
                            <option value="11">11位小數</option>
                            <option value="12">12位小數</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label>數據管理：</label>
                        <button id="refresh-data-btn" class="refresh-data-btn" title="重新載入CSV數據 (Ctrl+R 或 F5)">
                            <span class="refresh-icon">🔄</span>
                            <span class="refresh-text">重新載入數據</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 隨機生成資訊模態窗口 -->
    <div class="random-info-modal" id="randomInfoModal">
        <div class="random-info-modal-content">
            <div class="random-info-modal-sidebar">
                <div class="random-info-modal-sidebar-item active" data-section="overview">簡述</div>
                <div class="random-info-modal-sidebar-item" data-section="probability">詳細機率說明</div>
            </div>
            <div class="random-info-modal-main">
                <button class="random-info-modal-close">&times;</button>
                <div class="random-info-section-modal" id="overview-section">
                    <h2>隨機生成模式簡述</h2>
                    <div class="random-mode-info">
                        <div class="random-mode-item">
                            <div class="random-mode-header">
                                <span class="random-mode-icon normal">🎲</span>
                                <h3>隨機生成按鈕 (藍底)</h3>
                            </div>
                            <p>與遊戲中強化機制相同，至少會有一個副詞條為角色需要詞條</p>
                        </div>
                        <div class="random-mode-item">
                            <div class="random-mode-header">
                                <span class="random-mode-icon lucky">🎲</span>
                                <h3>幸運隨機生成按鈕 (金底)</h3>
                            </div>
                            <p>與遊戲中強化機制大致相同，至少會有兩個副詞條為角色需要詞條，強化次數一定有5次，較容易強化到有效詞條</p>
                        </div>
                        <div class="random-mode-item">
                            <div class="random-mode-header">
                                <span class="random-mode-icon super">🎲</span>
                                <h3>超級幸運隨機生成按鈕 (彩底)</h3>
                            </div>
                            <p>與遊戲中強化機制大致不同，強化時數值會有較高機率強化成較高的數值，至少會有三個副詞條為角色需要詞條，強化次數一定有5次，非常容易強化到有效詞條</p>
                        </div>
                        <div class="random-mode-item">
                            <div class="random-mode-header">
                                <h3>注 :</h3>
                            </div>
                            <p>不論哪種隨機生成，生成出的儀器皆是遊戲內可能存在的詞條，但機率不同</p>
                        </div>
                    </div>
                </div>
                <div class="random-info-section-modal" id="probability-section" style="display: none;">
                    <h2>詳細機率說明</h2>
                    <div class="probability-content">
                        <div class="probability-mode">
                            <h3>🎲 隨機生成 (普通模式)</h3>
                            <div class="probability-details">
                                <h4>副詞條選擇：</h4>
                                <ul>
                                    <li>100% 機率至少有 1 個重要副詞條</li>
                                    <li>50% 機率有 2 個重要副詞條</li>
                                    <li>剩餘位置從次要/普通副詞條中隨機選擇</li>
                                </ul>
                                <h4>強化次數：</h4>
                                <ul>
                                    <li>50% 機率 4 次強化</li>
                                    <li>50% 機率 5 次強化</li>
                                </ul>
                                <h4>強化分配：</h4>
                                <ul>
                                    <li>所有副詞條被強化的機率相等</li>
                                </ul>
                                <h4>數值範圍：</h4>
                                <ul>
                                    <li>從低、中、高三個數值中等機率隨機選擇</li>
                                </ul>
                            </div>
                        </div>
                        <div class="probability-mode">
                            <h3>🎲 幸運隨機生成</h3>
                            <div class="probability-details">
                                <h4>副詞條選擇：</h4>
                                <ul>
                                    <li>100% 機率至少有 2 個重要副詞條</li>
                                    <li>50% 機率有 3 個重要副詞條</li>
                                    <li>如重要副詞條不足，用次要副詞條補充</li>
                                </ul>
                                <h4>強化次數：</h4>
                                <ul>
                                    <li>固定 5 次強化</li>
                                </ul>
                                <h4>強化分配：</h4>
                                <ul>
                                    <li>重要副詞條被強化的機率是其他副詞條的 2 倍</li>
                                </ul>
                                <h4>數值範圍：</h4>
                                <ul>
                                    <li>從低、中、高三個數值中等機率隨機選擇</li>
                                </ul>
                            </div>
                        </div>
                        <div class="probability-mode">
                            <h3>🎲 超級幸運隨機生成</h3>
                            <div class="probability-details">
                                <h4>副詞條選擇：</h4>
                                <ul>
                                    <li>100% 機率至少有 3 個重要副詞條</li>
                                    <li>75% 機率有 4 個重要副詞條</li>
                                    <li>如重要副詞條不足，用次要副詞條補充</li>
                                </ul>
                                <h4>強化次數：</h4>
                                <ul>
                                    <li>固定 5 次強化</li>
                                </ul>
                                <h4>強化分配：</h4>
                                <ul>
                                    <li>重要副詞條被強化的機率是其他副詞條的 3 倍</li>
                                </ul>
                                <h4>數值範圍（權重隨機）：</h4>
                                <ul>
                                    <li>低數值：權重 1 (約 7.1%)</li>
                                    <li>中數值：權重 4 (約 28.6%)</li>
                                    <li>高數值：權重 9 (約 64.3%)</li>
                                </ul>
                                <div class="value-ranges">
                                    <h5>具體數值範圍：</h5>
                                    <div class="value-table">
                                        <div class="value-row">
                                            <span class="stat-name">HP</span>
                                            <span class="values">33.87 / 38.1 / 42.34</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">ATK</span>
                                            <span class="values">16.94 / 19.05 / 21.17</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">DEF</span>
                                            <span class="values">16.94 / 19.05 / 21.17</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">HP%</span>
                                            <span class="values">3.46% / 3.89% / 4.32%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">ATK%</span>
                                            <span class="values">3.46% / 3.89% / 4.32%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">DEF%</span>
                                            <span class="values">4.32% / 4.86% / 5.4%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">暴擊率</span>
                                            <span class="values">2.59% / 2.92% / 3.24%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">暴擊傷害</span>
                                            <span class="values">5.18% / 5.83% / 6.48%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">效果命中</span>
                                            <span class="values">3.46% / 3.89% / 4.32%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">效果抵抗</span>
                                            <span class="values">3.46% / 3.89% / 4.32%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">擊破特攻</span>
                                            <span class="values">5.18% / 5.83% / 6.48%</span>
                                        </div>
                                        <div class="value-row">
                                            <span class="stat-name">速度</span>
                                            <span class="values">2 / 2.3 / 2.6</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 光錐選擇模態窗口 -->
    <div class="lightcone-modal" id="lightconeModal">
        <div class="lightcone-modal-content">
            <div class="lightcone-modal-header">
                <h2>選擇光錐</h2>
                <button class="lightcone-modal-close">&times;</button>
            </div>
            <div class="lightcone-modal-body">
                <div class="lightcone-filters">
                    <div class="filter-group">
                        <h3>命途</h3>
                        <div class="path-selector">
                            <label class="path-option">
                                <input type="checkbox" value="毀滅" class="path-checkbox">
                                <span class="path-text destruction">毀滅</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="巡獵" class="path-checkbox">
                                <span class="path-text hunt">巡獵</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="智識" class="path-checkbox">
                                <span class="path-text erudition">智識</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="同諧" class="path-checkbox">
                                <span class="path-text harmony">同諧</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="虛無" class="path-checkbox">
                                <span class="path-text nihility">虛無</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="存護" class="path-checkbox">
                                <span class="path-text preservation">存護</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="豐饒" class="path-checkbox">
                                <span class="path-text abundance">豐饒</span>
                            </label>
                            <label class="path-option">
                                <input type="checkbox" value="記憶" class="path-checkbox">
                                <span class="path-text remembrance">記憶</span>
                            </label>
                        </div>
                    </div>
                    <div class="filter-group">
                        <h3>星數</h3>
                        <div class="star-selector">
                            <label class="star-option">
                                <input type="checkbox" value="3" class="star-checkbox">
                                <span class="star-text">3⭐</span>
                            </label>
                            <label class="star-option">
                                <input type="checkbox" value="4" class="star-checkbox">
                                <span class="star-text">4⭐</span>
                            </label>
                            <label class="star-option">
                                <input type="checkbox" value="5" class="star-checkbox">
                                <span class="star-text">5⭐</span>
                            </label>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="filter-clear-btn">清除篩選</button>
                        <button class="filter-all-btn">全選</button>
                        <button class="lightcone-remove-btn" id="lightcone-remove-btn" style="display: none;">卸下光錐</button>
                    </div>
                </div>
                <div class="lightcone-grid" id="lightcone-grid">
                    <!-- 光錐卡片將在這裡動態生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 角色選擇模態窗口 -->
    <div class="character-modal" id="characterModal">
        <div class="character-modal-content">
            <div class="character-modal-header">
                <h2>選擇角色</h2>
                <button class="character-modal-close">&times;</button>
            </div>
            <div class="character-modal-body">
                                    <div class="character-filters">
                        <div class="filter-group">
                            <h3>命途</h3>
                            <div class="path-selector">
                                <label class="path-option">
                                    <input type="checkbox" value="毀滅" class="character-path-checkbox">
                                    <span class="path-text destruction">毀滅</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="巡獵" class="character-path-checkbox">
                                    <span class="path-text hunt">巡獵</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="智識" class="character-path-checkbox">
                                    <span class="path-text erudition">智識</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="同諧" class="character-path-checkbox">
                                    <span class="path-text harmony">同諧</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="虛無" class="character-path-checkbox">
                                    <span class="path-text nihility">虛無</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="存護" class="character-path-checkbox">
                                    <span class="path-text preservation">存護</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="豐饒" class="character-path-checkbox">
                                    <span class="path-text abundance">豐饒</span>
                                </label>
                                <label class="path-option">
                                    <input type="checkbox" value="記憶" class="character-path-checkbox">
                                    <span class="path-text remembrance">記憶</span>
                                </label>
                            </div>
                        </div>
                        <div class="filter-group">
                            <h3>屬性</h3>
                            <div class="element-selector">
                                <label class="element-option">
                                    <input type="checkbox" value="物理" class="character-element-checkbox">
                                    <span class="element-text physical">物理</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="火" class="character-element-checkbox">
                                    <span class="element-text fire">火</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="冰" class="character-element-checkbox">
                                    <span class="element-text ice">冰</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="雷" class="character-element-checkbox">
                                    <span class="element-text lightning">雷</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="風" class="character-element-checkbox">
                                    <span class="element-text wind">風</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="量子" class="character-element-checkbox">
                                    <span class="element-text quantum">量子</span>
                                </label>
                                <label class="element-option">
                                    <input type="checkbox" value="虛數" class="character-element-checkbox">
                                    <span class="element-text imaginary">虛數</span>
                                </label>
                            </div>
                        </div>
                        <div class="filter-group">
                            <h3>星數</h3>
                            <div class="star-selector">
                                <label class="star-option">
                                    <input type="checkbox" value="4" class="character-star-checkbox">
                                    <span class="star-text">4⭐</span>
                                </label>
                                <label class="star-option">
                                    <input type="checkbox" value="5" class="character-star-checkbox">
                                    <span class="star-text">5⭐</span>
                                </label>
                            </div>
                        </div>
                    <div class="filter-actions">
                        <button class="character-filter-clear-btn">清除篩選</button>
                        <button class="character-filter-all-btn">全選</button>
                    </div>
                </div>
                <div class="character-grid" id="character-grid">
                    <!-- 角色卡片將在這裡動態生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 儀器選擇模態窗口 -->
    <div class="relic-modal" id="relicModal">
        <div class="relic-modal-content">
            <div class="relic-modal-header">
                <h2>選擇儀器</h2>
                <button class="relic-modal-close">&times;</button>
            </div>
            <div class="relic-modal-body">
                <div class="relic-filters">
                    <div class="filter-group">
                        <h3>類型</h3>
                        <div class="relic-type-selector">
                            <label class="relic-type-option">
                                <input type="checkbox" value="外圈" class="relic-type-checkbox">
                                <span class="relic-type-text">外圈</span>
                            </label>
                            <label class="relic-type-option">
                                <input type="checkbox" value="內圈" class="relic-type-checkbox">
                                <span class="relic-type-text">內圈</span>
                            </label>
                        </div>
                    </div>
                    <div class="filter-actions">
                        <button class="relic-filter-clear-btn">清除篩選</button>
                        <button class="relic-filter-all-btn">全選</button>
                        <button class="relic-clear-selection-btn">清空選擇</button>
                    </div>
                </div>
                <div class="relic-selection-info">
                    <p>外圈儀器：選擇1個為4件套，選擇2個為各2件套</p>
                    <div class="selected-relics">
                        <div class="selected-outer-relics">
                            <span class="selected-label">已選外圈：</span>
                            <span class="selected-outer-list">無</span>
                        </div>
                        <div class="selected-inner-relic">
                            <span class="selected-label">已選內圈：</span>
                            <span class="selected-inner-list">無</span>
                        </div>
                    </div>
                </div>
                <div class="relic-grid" id="relic-grid">
                    <!-- 儀器卡片將在這裡動態生成 -->
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html> 